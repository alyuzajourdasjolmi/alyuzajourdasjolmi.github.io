import{s as r}from"./supabaseClient-Q9RsP7pu.js";const L=document.getElementById("login-section"),l=document.getElementById("dashboard-section"),g=document.getElementById("login-form"),c=document.getElementById("login-error"),p=document.getElementById("logout-btn"),I=document.getElementById("user-info"),u=document.getElementById("product-table-body"),i=document.getElementById("product-form-container"),s=document.getElementById("product-form"),B=document.getElementById("add-product-btn"),b=document.getElementById("cancel-btn"),y=document.getElementById("event-table-body"),a=document.getElementById("event-form-container"),m=document.getElementById("event-form"),h=document.getElementById("add-event-btn"),w=document.getElementById("cancel-event-btn");async function f(){const{data:{user:t}}=await r.auth.getUser();t?T(t):k()}function k(){L.style.display="block",l.style.display="none",l.classList.remove("active")}function T(t){L.style.display="none",l.style.display="block",l.classList.add("active"),I&&(I.innerText=`Welcome, ${t.email}`),v(),E()}g&&g.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("email").value,n=document.getElementById("password").value;c&&(c.innerText="",c.style.display="none");try{const{data:o,error:d}=await r.auth.signInWithPassword({email:e,password:n});d?c&&(c.innerText=d.message,c.style.display="block"):f()}catch(o){c&&(c.innerText="Connection error: "+o.message,c.style.display="block")}});p&&p.addEventListener("click",async()=>{await r.auth.signOut(),f()});async function v(){const{data:t,error:e}=await r.from("products").select("*").order("name",{ascending:!0});if(e){console.error("Error fetching products:",e);return}$(t||[])}function $(t){u&&(u.innerHTML="",t.forEach(e=>{const n=document.createElement("tr");n.innerHTML=`
            <td>${e.name||""}</td>
            <td>${e.price||""}</td>
            <td>${e.category||""}</td>
            <td>${e.image||""}</td>
            <td>
                <button class="action-btn btn-edit" data-id="${e.id}">Edit</button>
                <button class="action-btn btn-delete" data-id="${e.id}">Delete</button>
            </td>
        `,u.appendChild(n)}),document.querySelectorAll("#product-table-body .btn-edit").forEach(e=>{e.addEventListener("click",()=>D(e.dataset.id,t))}),document.querySelectorAll("#product-table-body .btn-delete").forEach(e=>{e.addEventListener("click",()=>P(e.dataset.id))}),window.allProducts=t)}B&&B.addEventListener("click",()=>{s&&s.reset();const t=document.getElementById("product-id");t&&(t.value="");const e=document.getElementById("form-title");e&&(e.innerText="Add Product"),i&&(i.style.display="block")});b&&b.addEventListener("click",()=>{i&&(i.style.display="none")});function D(t,e){const n=e.find(o=>o.id==t);if(n){document.getElementById("product-id").value=n.id,document.getElementById("prod-name").value=n.name,document.getElementById("prod-price").value=n.price,document.getElementById("prod-image").value=n.image||"",document.getElementById("prod-category").value=n.category;const o=document.getElementById("form-title");o&&(o.innerText="Edit Product"),i&&(i.style.display="block")}}async function P(t){if(confirm("Are you sure you want to delete this product?")){const{error:e}=await r.from("products").delete().eq("id",t);e&&console.error("Delete error:",e),v()}}s&&s.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("product-id"),n=e?e.value:"",o={name:document.getElementById("prod-name")?.value||"",price:document.getElementById("prod-price")?.value||"",image:document.getElementById("prod-image")?.value||"",category:document.getElementById("prod-category")?.value||""};if(n){const{error:d}=await r.from("products").update(o).eq("id",n);d&&(console.error("Update error:",d),alert("Error: "+d.message))}else{const{error:d}=await r.from("products").insert(o);d&&(console.error("Insert error:",d),alert("Error: "+d.message))}i&&(i.style.display="none"),v()});async function E(){const{data:t,error:e}=await r.from("events").select("*").order("title",{ascending:!0});if(e){console.error("Error fetching events:",e);return}q(t||[])}function q(t){y&&(y.innerHTML="",t.forEach(e=>{const n=document.createElement("tr");n.innerHTML=`
            <td><strong>${String(e.event_day).padStart(2,"0")}</strong> ${e.event_month}</td>
            <td>${e.title||""}</td>
            <td>${e.description||""}</td>
            <td>
                <button class="action-btn btn-edit" data-event-id="${e.id}">Edit</button>
                <button class="action-btn btn-delete" data-event-id="${e.id}">Delete</button>
            </td>
        `,y.appendChild(n)}),document.querySelectorAll("[data-event-id].btn-edit").forEach(e=>{e.addEventListener("click",()=>x(e.dataset.eventId,t))}),document.querySelectorAll("[data-event-id].btn-delete").forEach(e=>{e.addEventListener("click",()=>A(e.dataset.eventId))}))}h&&h.addEventListener("click",()=>{m&&m.reset();const t=document.getElementById("event-id");t&&(t.value="");const e=document.getElementById("event-form-title");e&&(e.innerText="Add Event"),a&&(a.style.display="block")});w&&w.addEventListener("click",()=>{a&&(a.style.display="none")});function x(t,e){const n=e.find(o=>o.id==t);if(n){document.getElementById("event-id").value=n.id,document.getElementById("event-title").value=n.title,document.getElementById("event-description").value=n.description,document.getElementById("event-day").value=n.event_day,document.getElementById("event-month").value=n.event_month;const o=document.getElementById("event-form-title");o&&(o.innerText="Edit Event"),a&&(a.style.display="block")}}async function A(t){if(confirm("Are you sure you want to delete this event?")){const{error:e}=await r.from("events").delete().eq("id",t);e&&console.error("Delete error:",e),E()}}m&&m.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("event-id"),n=e?e.value:"",o={title:document.getElementById("event-title")?.value||"",description:document.getElementById("event-description")?.value||"",event_day:parseInt(document.getElementById("event-day")?.value)||1,event_month:document.getElementById("event-month")?.value||"Jan"};if(n){const{error:d}=await r.from("events").update(o).eq("id",n);d&&(console.error("Update error:",d),alert("Error: "+d.message))}else{const{error:d}=await r.from("events").insert(o);d&&(console.error("Insert error:",d),alert("Error: "+d.message))}a&&(a.style.display="none"),E()});f();
